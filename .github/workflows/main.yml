name: CI/CD Pipeline

on:
  # Автоматический запуск при любом коммите в любую ветку
  push:
    branches: ['**']
  pull_request:
    branches: [master, main]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: 📥 Checkout code
      uses: actions/checkout@v4
      
    - name: 🐍 Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: 🔍 Check Python syntax
      run: |
        echo "Проверка синтаксиса Python файлов..."
        for file in *.py; do
          if [ -f "$file" ]; then
            python -m py_compile "$file" && echo "✅ $file - OK"
          fi
        done
        
    - name: 🧪 Run tests
      run: |
        echo "Запуск тестов..."
        # Создадим простой тест, если его нет
        if [ ! -f "test_simple.py" ]; then
          cat > test_simple.py << 'EOF'
def test_addition():
    assert 1 + 1 == 2
    print("✅ Basic test passed")

if __name__ == "__main__":
    test_addition()
EOF
        fi
        python test_simple.py
