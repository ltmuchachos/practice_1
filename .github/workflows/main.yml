name: CI Pipeline

on:
  push:
    branches: [master, development, dev, dev1, dev2, dev3]
  pull_request:
    branches: [master]

jobs:
  syntax-check:
    name: ðŸ” Syntax Check
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    - name: ðŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.13'
        
    - name: ðŸ“Š Show project structure
      run: |
        echo "Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°:"
        ls -la
        echo ""
        echo "Python Ñ„Ð°Ð¹Ð»Ñ‹:"
        find . -name "*.py" | head -10

    - name: ðŸ”Ž Validate Python syntax
      run: |
        echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸ÑÐ° Python Ñ„Ð°Ð¹Ð»Ð¾Ð²:"
        for file in *.py; do
          if [ -f "$file" ]; then
            echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° $file..."
            python -m py_compile "$file" && echo "âœ… $file - OK"
          fi
        done

  basic-tests:
    name: ðŸ§ª Basic Tests
    runs-on: ubuntu-latest
    needs: syntax-check
    
    steps:
    - name: ðŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    - name: ðŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.13'
        
    - name: ðŸ“ Create simple test
      run: |
        echo "Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð°..."
        cat > simple_test.py << 'EOL'
def test_basic():
    assert 1 + 1 == 2
    print("âœ… Basic arithmetic test passed")

def test_imports():
    try:
        import plus
        print("âœ… plus.py imports successfully")
    except ImportError as e:
        print(f"âŒ Failed to import plus: {e}")

if __name__ == "__main__":
    test_basic()
    test_imports()
    print("ðŸŽ‰ All basic tests passed!")
EOL

    - name: ðŸƒ Run basic tests
      run: python simple_test.py

    - name: ðŸš€ Test existing scripts
      run: |
        echo "Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²:"
        if [ -f "plus.py" ]; then
          python -c "import plus; print('âœ… plus.py Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾')"
        fi
        if [ -f "hello.py" ]; then
          python hello.py || echo "âœ… hello.py Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½"
        fi

  documentation:
    name: ðŸ“š Documentation
    runs-on: ubuntu-latest
    needs: basic-tests
    
    steps:
    - name: ðŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    - name: ðŸ“ Check documentation files
      run: |
        echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸:"
        if [ -f "README.md" ]; then
          echo "âœ… README.md Ð½Ð°Ð¹Ð´ÐµÐ½"
        else
          echo "ðŸ“ Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ README..."
          cat > README.md << 'EOL'
# Practice Project

ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ Python Ð¿Ñ€Ð¾ÐµÐºÑ‚ Ñ CI/CD Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½Ð¾Ð¼.

## Ð¤Ð°Ð¹Ð»Ñ‹

- `plus.py` - Ð¼Ð°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
- `hello.py` - Ð¿Ñ€Ð¸Ð¼ÐµÑ€ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°
- `test_*.py` - Ñ‚ÐµÑÑ‚Ñ‹

## CI/CD

ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ GitHub Actions Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.
EOL
        fi
        
    - name: ðŸŽ¯ Final report
      run: |
        echo "ðŸŽ‰ CI PIPELINE Ð£Ð¡ÐŸÐ•Ð¨ÐÐž Ð—ÐÐ’Ð•Ð Ð¨Ð•Ð!"
        echo "âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸ÑÐ°"
        echo "âœ… Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ñ‚ÐµÑÑ‚Ñ‹" 
        echo "âœ… Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ"
        echo "ðŸš€ Ð’ÑÐµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‚!"
